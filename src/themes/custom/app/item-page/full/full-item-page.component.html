<div class="landing-wrapper" *ngVar="(itemRD$ | async) as itemRD">
  <div class="landing-background">
    <img src="assets/test/images/fondo-test.jpg" alt="Background" class="bg-img">
  </div>

  <header class="landing-header">
    <div class="logo-group">
      <div class="logo-container">
        <img src="assets/images/dspace-logo.svg" alt="Ministerio de Educación" class="ministry-logo">
        <div class="logo-text">
          <span>Ministerio de</span>
          <span>Educación</span>
          <small>GUATEMALA</small>
        </div>
      </div>
      <div class="logo-container">
        <img src="assets/images/dspace-logo.svg" alt="INNOVA" class="ministry-logo">
        <div class="logo-text">
          <span>INNOVA</span>
        </div>
      </div>
    </div>
    <div class="auth-container">
      <!-- Si NO está autenticado, mostrar botón de iniciar sesión -->
      <ng-container *ngIf="!(isAuthenticated$ | async)">
        <a routerLink="/login" class="login-pill">Iniciar Sesión</a>
      </ng-container>
      
      <!-- Si ESTÁ autenticado, mostrar menú de usuario -->
      <ng-container *ngIf="isAuthenticated$ | async">
        <div class="user-menu-container">
          <a routerLink="/profile" class="user-pill" title="Mi Perfil">
            <i class="fas fa-user-circle"></i>
            <span>Mi Perfil</span>
          </a>
          <a routerLink="/logout" class="logout-pill" title="Cerrar Sesión">
            <i class="fas fa-sign-out-alt"></i>
          </a>
        </div>
      </ng-container>
    </div>
  </header>

  <main class="landing-main">
    <div class="content-grid">
      <!-- Columna del Astronauta (izquierda) -->
      <div class="character-col d-none d-xl-block">
        <img src="assets/test/images/astronauta.png" alt="Ajk'iy" class="astronaut-char">
      </div>

      <!-- Columna del Contenido (derecha) -->
      <div class="interaction-col">
        @if (itemRD?.hasSucceeded) {
          <div class="full-item-container" @fadeInOut>
            @if (itemRD?.payload; as item) {
              <div class="full-item-content">
                <!-- Alerts and notifications -->
                <div class="alerts-container">
                  <ds-item-alerts [item]="item"></ds-item-alerts>
                  <ds-item-versions-notice [item]="item"></ds-item-versions-notice>
                </div>

                @if (!item.isWithdrawn || (isAdmin$|async)) {
                  <div class="full-item-info">
                    <!-- Title Section -->
                    <div class="title-section">
                      <ds-item-page-title-field class="me-auto" [item]="item"></ds-item-page-title-field>
                      <ds-dso-edit-menu></ds-dso-edit-menu>
                    </div>

                    <!-- Simple View Button -->
                    @if (!fromSubmissionObject) {
                      <div class="view-toggle">
                        <a class="btn-simple-view" [routerLink]="[(itemPageRoute$ | async)]">
                          <i class="fas fa-compress-alt"></i>
                          {{"item.page.link.simple" | translate}}
                        </a>
                      </div>
                    }

                    <!-- Metadata Table -->
                    <div class="metadata-section">
                      <h2 class="section-title">
                        <i class="fas fa-database"></i>
                        Metadatos Completos
                      </h2>
                      <div class="table-responsive">
                        <table class="metadata-table">
                          <thead>
                            <tr>
                              <th>Campo</th>
                              <th>Valor</th>
                              <th>Idioma</th>
                            </tr>
                          </thead>
                          <tbody>
                            @for (mdEntry of (metadata$ | async) | keyvalue; track mdEntry) {
                              @for (mdValue of mdEntry.value; track mdValue) {
                                <tr>
                                  <td class="field-key">{{mdEntry.key}}</td>
                                  <td class="field-value">{{mdValue.value}}</td>
                                  <td class="field-lang">{{mdValue.language || '-'}}</td>
                                </tr>
                              }
                            }
                          </tbody>
                        </table>
                      </div>
                    </div>

                    <!-- Files Section -->
                    <div class="files-section">
                      <h2 class="section-title">
                        <i class="fas fa-folder-open"></i>
                        Archivos
                      </h2>
                      <ds-item-page-full-file-section [item]="item"></ds-item-page-full-file-section>
                    </div>

                    <!-- Collections Section -->
                    <div class="collections-section">
                      <h2 class="section-title">
                        <i class="fas fa-layer-group"></i>
                        Colecciones
                      </h2>
                      <ds-item-page-collections [item]="item"></ds-item-page-collections>
                    </div>

                    <!-- Versions Section -->
                    <div class="versions-section">
                      <ds-item-versions class="mt-2" [item]="item"></ds-item-versions>
                    </div>

                    <!-- Back Button (for submission preview) -->
                    @if (fromSubmissionObject) {
                      <div class="button-row">
                        <button class="btn-back" (click)="back()">
                          <i class="fas fa-arrow-left"></i>
                          {{'item.page.return' | translate}}
                        </button>
                      </div>
                    }
                  </div>
                }
              </div>
            }
          </div>
        }
        @if (itemRD?.hasFailed) {
          <div class="error-container">
            <ds-error message="{{'error.item' | translate}}"></ds-error>
          </div>
        }
        @if (itemRD?.isLoading) {
          <div class="loading-container">
            <ds-loading message="{{'loading.item' | translate}}"></ds-loading>
          </div>
        }
      </div>
    </div>
  </main>
</div>
